{% extends 'base.html' %}

{% block content %}
<div class="bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl shadow-xl overflow-hidden mb-8">
    <div class="container mx-auto px-6 py-16 flex flex-col md:flex-row items-center">
        <div class="md:w-1/2 mb-8 md:mb-0">
            <h1 class="text-4xl md:text-5xl font-bold text-white leading-tight mb-4">
                Smart Attendance System
            </h1>
            <p class="text-blue-100 text-lg md:text-xl mb-8">
                A modern solution for tracking attendance using facial recognition technology.
                Secure, efficient, and user-friendly.
            </p>
            <div class="flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4">
                {% if current_user.is_authenticated %}
                    <a href="{{ url_for('attendance') }}" class="bg-white text-indigo-600 hover:bg-blue-50 font-semibold py-3 px-6 rounded-lg shadow-md transition duration-300 text-center">
                        <i class="fas fa-clipboard-check mr-2"></i> Mark Attendance
                    </a>
                    <a href="{{ url_for('courses.calendar_view') }}" class="bg-indigo-800 text-white hover:bg-indigo-700 font-semibold py-3 px-6 rounded-lg shadow-md transition duration-300 text-center">
                        <i class="fas fa-calendar-alt mr-2"></i> View Schedule
                    </a>
                {% else %}
                    <a href="{{ url_for('auth.login') }}" class="bg-white text-indigo-600 hover:bg-blue-50 font-semibold py-3 px-6 rounded-lg shadow-md transition duration-300 text-center">
                        <i class="fas fa-sign-in-alt mr-2"></i> Login
                    </a>
                    <a href="{{ url_for('auth.register') }}" class="bg-indigo-800 text-white hover:bg-indigo-700 font-semibold py-3 px-6 rounded-lg shadow-md transition duration-300 text-center">
                        <i class="fas fa-user-plus mr-2"></i> Register
                    </a>
                {% endif %}
            </div>
        </div>
        <div class="md:w-1/2 flex justify-center">
            <div class="relative">
                <div class="absolute inset-0 bg-blue-600 rounded-full opacity-20 blur-3xl transform -translate-x-4 translate-y-4"></div>
                <img src="{{ url_for('static', filename='images/face-recognition.png') }}" alt="Face Recognition" class="relative z-10 w-full max-w-md rounded-lg shadow-2xl">
            </div>
        </div>
    </div>
</div>

{% if current_user.is_authenticated %}
    <!-- User Dashboard -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12">
        <!-- Quick Attendance Card -->
        <div class="bg-white rounded-lg shadow-md overflow-hidden card-hover">
            <div class="p-6">
                <div class="flex items-center mb-4">
                    <div class="rounded-full bg-blue-100 p-3 mr-4">
                        <i class="fas fa-camera text-blue-600 text-xl"></i>
                    </div>
                    <h2 class="text-xl font-semibold text-gray-800">Quick Attendance</h2>
                </div>
                <p class="text-gray-600 mb-4">
                    Mark your attendance quickly for active lectures.
                </p>
                <a href="{{ url_for('attendance') }}" class="block text-center bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded transition duration-300">
                    Mark Attendance
                </a>
            </div>
        </div>

        <!-- My Courses Card -->
        <div class="bg-white rounded-lg shadow-md overflow-hidden card-hover">
            <div class="p-6">
                <div class="flex items-center mb-4">
                    <div class="rounded-full bg-green-100 p-3 mr-4">
                        <i class="fas fa-book text-green-600 text-xl"></i>
                    </div>
                    <h2 class="text-xl font-semibold text-gray-800">My Courses</h2>
                </div>
                <p class="text-gray-600 mb-4">
                    Access your enrolled courses, materials, and lectures.
                </p>
                <a href="{{ url_for('courses.index') }}" class="block text-center bg-green-500 hover:bg-green-600 text-white font-medium py-2 px-4 rounded transition duration-300">
                    View Courses
                </a>
            </div>
        </div>

        <!-- Schedule Card -->
        <div class="bg-white rounded-lg shadow-md overflow-hidden card-hover">
            <div class="p-6">
                <div class="flex items-center mb-4">
                    <div class="rounded-full bg-purple-100 p-3 mr-4">
                        <i class="fas fa-calendar-alt text-purple-600 text-xl"></i>
                    </div>
                    <h2 class="text-xl font-semibold text-gray-800">My Schedule</h2>
                </div>
                <p class="text-gray-600 mb-4">
                    View your weekly schedule and upcoming lectures.
                </p>
                <a href="{{ url_for('courses.calendar_view') }}" class="block text-center bg-purple-500 hover:bg-purple-600 text-white font-medium py-2 px-4 rounded transition duration-300">
                    View Calendar
                </a>
            </div>
        </div>
    </div>

    <!-- Active Lectures Section -->
    <div class="bg-white rounded-lg shadow-md overflow-hidden mb-12">
        <div class="border-b px-6 py-4">
            <h2 class="text-xl font-semibold text-gray-800">Active Lectures</h2>
        </div>
        <div class="p-6" x-data="{ activeLectures: [] }" x-init="
            fetch('{{ url_for('courses.get_active_lectures') }}')
                .then(response => response.json())
                .then(data => { activeLectures = data.lectures })
                .catch(error => console.error('Error fetching active lectures:', error))
        ">
            <template x-if="activeLectures.length > 0">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <template x-for="lecture in activeLectures" :key="lecture.id">
                        <div class="border rounded-lg p-4 hover:bg-blue-50 transition duration-300">
                            <div class="flex justify-between items-start">
                                <div>
                                    <h3 class="font-semibold text-lg" x-text="lecture.title"></h3>
                                    <p class="text-gray-600" x-text="lecture.course_code + ' - ' + lecture.course_name"></p>
                                    <div class="flex items-center mt-2 text-sm text-gray-500">
                                        <i class="fas fa-map-marker-alt mr-1"></i>
                                        <span x-text="lecture.location"></span>
                                        <span class="mx-2">â€¢</span>
                                        <i class="fas fa-clock mr-1"></i>
                                        <span x-text="lecture.time"></span>
                                    </div>
                                </div>
                                <a :href="lecture.url" class="bg-blue-500 hover:bg-blue-600 text-white text-sm font-medium py-1 px-3 rounded transition duration-300">
                                    Attend
                                </a>
                            </div>
                        </div>
                    </template>
                </div>
            </template>
            <template x-if="activeLectures.length === 0">
                <div class="text-center py-8">
                    <div class="text-gray-400 mb-2">
                        <i class="fas fa-calendar-times text-4xl"></i>
                    </div>
                    <p class="text-gray-600">No active lectures at the moment.</p>
                </div>
            </template>
        </div>
    </div>

    {% if current_user.is_admin %}
    <!-- Admin Quick Actions -->
    <div class="bg-white rounded-lg shadow-md overflow-hidden mb-12">
        <div class="border-b px-6 py-4 bg-gray-50">
            <h2 class="text-xl font-semibold text-gray-800">Admin Quick Actions</h2>
        </div>
        <div class="p-6">
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                <a href="{{ url_for('admin') }}" class="flex items-center p-4 border rounded-lg hover:bg-gray-50 transition duration-300">
                    <div class="rounded-full bg-blue-100 p-2 mr-3">
                        <i class="fas fa-tachometer-alt text-blue-600"></i>
                    </div>
                    <span class="font-medium">Dashboard</span>
                </a>
                <a href="{{ url_for('courses.admin_courses') }}" class="flex items-center p-4 border rounded-lg hover:bg-gray-50 transition duration-300">
                    <div class="rounded-full bg-green-100 p-2 mr-3">
                        <i class="fas fa-book text-green-600"></i>
                    </div>
                    <span class="font-medium">Manage Courses</span>
                </a>
                <a href="{{ url_for('courses.new_course') }}" class="flex items-center p-4 border rounded-lg hover:bg-gray-50 transition duration-300">
                    <div class="rounded-full bg-purple-100 p-2 mr-3">
                        <i class="fas fa-plus-circle text-purple-600"></i>
                    </div>
                    <span class="font-medium">Add Course</span>
                </a>
                <a href="{{ url_for('auth.register') }}" class="flex items-center p-4 border rounded-lg hover:bg-gray-50 transition duration-300">
                    <div class="rounded-full bg-red-100 p-2 mr-3">
                        <i class="fas fa-user-plus text-red-600"></i>
                    </div>
                    <span class="font-medium">Add User</span>
                </a>
            </div>
        </div>
    </div>
    
    <!-- Stats Section (only for admin) -->
    <div class="bg-white rounded-lg shadow-md overflow-hidden mb-12">
        <div class="border-b px-6 py-4">
            <h2 class="text-xl font-semibold text-gray-800">System Statistics</h2>
        </div>
        <div class="p-6">
            <div class="grid grid-cols-2 md:grid-cols-4 gap-6 text-center">
                <div class="p-4">
                    <div class="text-3xl font-bold text-blue-600 mb-2">{{ stats.users }}</div>
                    <div class="text-gray-600">Registered Users</div>
                </div>
                <div class="p-4">
                    <div class="text-3xl font-bold text-green-600 mb-2">{{ stats.courses }}</div>
                    <div class="text-gray-600">Active Courses</div>
                </div>
                <div class="p-4">
                    <div class="text-3xl font-bold text-purple-600 mb-2">{{ stats.lectures }}</div>
                    <div class="text-gray-600">Total Lectures</div>
                </div>
                <div class="p-4">
                    <div class="text-3xl font-bold text-red-600 mb-2">{{ stats.attendances }}</div>
                    <div class="text-gray-600">Attendances Recorded</div>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

{% else %}
    <!-- Features Section for Non-Authenticated Users -->
    <div class="mb-12">
        <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">Features</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            <div class="bg-white rounded-lg shadow-md overflow-hidden card-hover">
                <div class="h-2 bg-blue-500"></div>
                <div class="p-6">
                    <div class="rounded-full bg-blue-100 p-3 inline-block mb-4">
                        <i class="fas fa-camera text-blue-600 text-xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-800 mb-2">Facial Recognition</h3>
                    <p class="text-gray-600">
                        Mark attendance with just your face. Our advanced facial recognition system ensures accurate and secure attendance tracking.
                    </p>
                </div>
            </div>
            
            <div class="bg-white rounded-lg shadow-md overflow-hidden card-hover">
                <div class="h-2 bg-green-500"></div>
                <div class="p-6">
                    <div class="rounded-full bg-green-100 p-3 inline-block mb-4">
                        <i class="fas fa-book text-green-600 text-xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-800 mb-2">Course Management</h3>
                    <p class="text-gray-600">
                        Access course materials, lectures, and schedules all in one place. Stay organized and never miss an important class.
                    </p>
                </div>
            </div>
            
            <div class="bg-white rounded-lg shadow-md overflow-hidden card-hover">
                <div class="h-2 bg-purple-500"></div>
                <div class="p-6">
                    <div class="rounded-full bg-purple-100 p-3 inline-block mb-4">
                        <i class="fas fa-chart-bar text-purple-600 text-xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-800 mb-2">Attendance Analytics</h3>
                    <p class="text-gray-600">
                        Track your attendance records and view detailed statistics. Instructors can monitor class participation and generate reports.
                    </p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- How It Works Section -->
    <div class="bg-gray-50 rounded-xl p-8 mb-12">
        <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">How It Works</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            <div class="flex flex-col items-center text-center">
                <div class="rounded-full bg-blue-500 text-white w-12 h-12 flex items-center justify-center text-xl font-bold mb-4">1</div>
                <h3 class="text-lg font-semibold text-gray-800 mb-2">Register Your Face</h3>
                <p class="text-gray-600">
                    Create an account and register your face with our secure system.
                </p>
            </div>
            
            <div class="flex flex-col items-center text-center">
                <div class="rounded-full bg-blue-500 text-white w-12 h-12 flex items-center justify-center text-xl font-bold mb-4">2</div>
                <h3 class="text-lg font-semibold text-gray-800 mb-2">Enroll in Courses</h3>
                <p class="text-gray-600">
                    Browse available courses and enroll in the ones you're taking.
                </p>
            </div>
            
            <div class="flex flex-col items-center text-center">
                <div class="rounded-full bg-blue-500 text-white w-12 h-12 flex items-center justify-center text-xl font-bold mb-4">3</div>
                <h3 class="text-lg font-semibold text-gray-800 mb-2">Mark Attendance</h3>
                <p class="text-gray-600">
                    Simply scan your face during class to mark your attendance automatically.
                </p>
            </div>
        </div>
    </div>
    
    <!-- Testimonials Section -->
    <div class="mb-12">
        <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">What Our Users Say</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <div class="bg-white rounded-lg shadow-md p-6">
                <div class="flex items-center mb-4">
                    <div class="w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center mr-4">
                        <span class="text-blue-600 font-bold text-xl">S</span>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-800">Sarah Johnson</h3>
                        <p class="text-gray-500 text-sm">Computer Science Student</p>
                    </div>
                </div>
                <p class="text-gray-600 italic">
                    "This system has made tracking attendance so much easier. No more signing sheets or calling out names. I just show up and my attendance is recorded automatically!"
                </p>
                <div class="mt-4 text-yellow-400">
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                </div>
            </div>
            
            <div class="bg-white rounded-lg shadow-md p-6">
                <div class="flex items-center mb-4">
                    <div class="w-12 h-12 rounded-full bg-green-100 flex items-center justify-center mr-4">
                        <span class="text-green-600 font-bold text-xl">M</span>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-800">Michael Chen</h3>
                        <p class="text-gray-500 text-sm">Engineering Professor</p>
                    </div>
                </div>
                <p class="text-gray-600 italic">
                    "As an instructor, this system has saved me countless hours that I would have spent on administrative tasks. Now I can focus more on teaching and less on paperwork."
                </p>
                <div class="mt-4 text-yellow-400">
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star-half-alt"></i>
                </div>
            </div>
            
            <div class="bg-white rounded-lg shadow-md p-6">
                <div class="flex items-center mb-4">
                    <div class="w-12 h-12 rounded-full bg-purple-100 flex items-center justify-center mr-4">
                        <span class="text-purple-600 font-bold text-xl">A</span>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-800">Aisha Patel</h3>
                        <p class="text-gray-500 text-sm">Department Administrator</p>
                    </div>
                </div>
                <p class="text-gray-600 italic">
                    "The analytics and reporting features have been invaluable for our department. We can now track attendance trends and identify students who might need additional support."
                </p>
                <div class="mt-4 text-yellow-400">
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                </div>
            </div>
        </div>
    </div>
    
    <!-- CTA Section -->
    <div class="bg-gradient-to-r from-indigo-600 to-blue-500 rounded-xl p-8 text-center text-white mb-12">
        <h2 class="text-2xl font-bold mb-4">Ready to Get Started?</h2>
        <p class="text-blue-100 mb-6 max-w-2xl mx-auto">
            Join thousands of students and educators who are already using our smart attendance system. Registration is quick and easy.
        </p>
        <div class="flex justify-center space-x-4">
            <a href="{{ url_for('auth.register') }}" class="bg-white text-indigo-600 hover:bg-blue-50 font-semibold py-3 px-6 rounded-lg shadow-md transition duration-300">
                <i class="fas fa-user-plus mr-2"></i> Register Now
            </a>
            <a href="#features" class="bg-transparent border-2 border-white text-white hover:bg-white/10 font-semibold py-3 px-6 rounded-lg transition duration-300">
                <i class="fas fa-info-circle mr-2"></i> Learn More
            </a>
        </div>
    </div>
{% endif %}

<!-- FAQ Section -->
<div class="mb-12" x-data="{ openQuestion: null }">
    <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">Frequently Asked Questions</h2>
    
    <div class="space-y-4">
        <div class="bg-white rounded-lg shadow-md overflow-hidden">
            <button 
                @click="openQuestion = openQuestion === 1 ? null : 1" 
                class="flex justify-between items-center w-full p-4 text-left font-semibold text-gray-800 hover:bg-gray-50"
            >
                <span>How does facial recognition attendance work?</span>
                <i class="fas" :class="openQuestion === 1 ? 'fa-chevron-up' : 'fa-chevron-down'"></i>
            </button>
            <div x-show="openQuestion === 1" class="p-4 bg-gray-50 border-t" x-collapse>
                <p class="text-gray-600">
                    Our system uses advanced facial recognition technology to identify students. When you arrive at class, 
                    simply look at the camera, and the system will match your face with your registered profile. If the match is successful, 
                    your attendance is automatically recorded for that lecture.
                </p>
            </div>
        </div>
        
        <div class="bg-white rounded-lg shadow-md overflow-hidden">
            <button 
                @click="openQuestion = openQuestion === 2 ? null : 2" 
                class="flex justify-between items-center w-full p-4 text-left font-semibold text-gray-800 hover:bg-gray-50"
            >
                <span>Is my facial data secure?</span>
                <i class="fas" :class="openQuestion === 2 ? 'fa-chevron-up' : 'fa-chevron-down'"></i>
            </button>
            <div x-show="openQuestion === 2" class="p-4 bg-gray-50 border-t" x-collapse>
                <p class="text-gray-600">
                    Yes, your facial data is securely stored and encrypted in our database. We do not share this data with any third parties, 
                    and it is only used for the purpose of attendance verification. You can request to delete your data at any time.
                </p>
            </div>
        </div>
        
        <div class="bg-white rounded-lg shadow-md overflow-hidden">
            <button 
                @click="openQuestion = openQuestion === 3 ? null : 3" 
                class="flex justify-between items-center w-full p-4 text-left font-semibold text-gray-800 hover:bg-gray-50"
            >
                <span>What if the system doesn't recognize my face?</span>
                <i class="fas" :class="openQuestion === 3 ? 'fa-chevron-up' : 'fa-chevron-down'"></i>
            </button>
            <div x-show="openQuestion === 3" class="p-4 bg-gray-50 border-t" x-collapse>
                <p class="text-gray-600">
                    If the system fails to recognize your face, you can try again with better lighting or a clearer view of your face. 
                    If problems persist, you can update your facial data in your profile settings or contact your instructor or administrator for manual attendance marking.
                </p>
            </div>
        </div>
        
        <div class="bg-white rounded-lg shadow-md overflow-hidden">
            <button 
                @click="openQuestion = openQuestion === 4 ? null : 4" 
                class="flex justify-between items-center w-full p-4 text-left font-semibold text-gray-800 hover:bg-gray-50"
            >
                <span>Can I use this system on my mobile device?</span>
                <i class="fas" :class="openQuestion === 4 ? 'fa-chevron-up' : 'fa-chevron-down'"></i>
            </button>
            <div x-show="openQuestion === 4" class="p-4 bg-gray-50 border-t" x-collapse>
                <p class="text-gray-600">
                    Yes, our system is fully responsive and works on mobile devices. You can mark your attendance using your smartphone's camera, 
                    access course materials, and view your schedule on the go.
                </p>
            </div>
        </div>
    </div>
</div>
{% endblock %}
